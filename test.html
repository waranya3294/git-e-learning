<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>แก้ไขข้อสอบ</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
  </head>
  <body>
    <div class="container-fluid mt-4 mb-3">
      <h2 class="mb-3" style="color: #343a40">แก้ไขข้อสอบ</h2>
      <div class="card shadow-sm rounded-1" style="border: none">
        <div class="card-body p-4">
          <!-- คำถามประเภทถูก/ผิด -->
          <div id="trueFalseQuestions">
            <header
              class="p-2 text-white text-center"
              style="background-color: #18b0bd; font-size: 24px"
            >
              แก้ไขข้อสอบประเภท ถูก/ผิด
            </header>
            <div class="table-responsive mt-3 mb-3">
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th class="text-center">โจทย์คำถาม</th>
                    <th class="text-center">คำตอบ</th>
                  </tr>
                </thead>
                <tbody id="trueFalseTableBody">
                  <!-- เติมข้อมูลโดย JavaScript -->
                </tbody>
              </table>
            </div>
          </div>

          <!-- คำถามประเภทปรนัย -->
          <div id="multipleChoiceQuestions">
            <header
              class="p-2 text-white text-center"
              style="background-color: #18b0bd; font-size: 24px"
            >
              แก้ไขข้อสอบประเภท ปรนัย
            </header>
            <div class="table-responsive mt-3 mb-3">
              <div id="multipleChoiceList"></div>
            </div>
          </div>

          <div class="text-end">
            <button
              class="btn btn-success"
              onclick="window.location.href='examgroup_maincontent.php'"
            >
              บันทึกการแก้ไข
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const trueFalseTableBody =
          document.getElementById("trueFalseTableBody");
        const multipleChoiceList =
          document.getElementById("multipleChoiceList");

        //  สร้างคำถามประเภท ถูก/ผิด
        for (let i = 1; i <= 20; i++) {
          trueFalseTableBody.innerHTML += `
      <tr>
        <td><input type="text" class="form-control" placeholder="คำถามที่ ${i}"></td>
        <td>
          <select class="form-control">
            <option value="true">ถูก</option>
            <option value="false">ผิด</option>
          </select>
        </td>
      </tr>
    `;
        }

        //  คำถามประเภท ปรนัย
        const questions = [
          [
            "การเตรียมพื้นผิวก่อนพ่นสีมีวัตถุประสงค์หลักเพื่ออะไร?",
            "เพิ่มการยึดเกาะของสี",
            "ลดความเงาของสี",
            "ทำให้สีแห้งเร็วขึ้น",
            "ลดการใช้สี",
            "ก",
          ],
          [
            "ในการพ่นสี ควรเลือกใช้อุปกรณ์ป้องกันส่วนบุคคล (PPE) ใด?",
            "ถุงมือยาง",
            "แว่นตานิรภัย",
            "หน้ากากกรองอากาศแบบไส้กรองมาตรฐาน",
            "รองเท้านิรภัย",
            "ค",
          ],
          [
            "สีรองพื้น(primer)มีหน้าที่อะไรในกระบวนการพ่นสี?",
            "ให้สีเงางาม",
            "ปกป้องพื้นผิวจากสนิมและเพิ่มการยึดเกาะของสีทับหน้า",
            "ให้ตกแต่งเพื่อความสวยงาม",
            "ทำให้สีไม่หลุดลอก",
            "ข",
          ],
          [
            "หากพ่นสีแล้วพบรอยคลื่นหรือฟองอากาศ ควรแก้ไขอย่างไร?",
            "พ่นสีเพิ่มทันที",
            "ใช้ความร้อนเร่งให้ฟองอากาศแตก",
            "พ่นสีใสเคลือบทับทันที",
            "ปล่อยให้แห้งแล้วขัดพื้นผิวก่อนพ่นซ้ำ",
            "ง",
          ],
          [
            "หากหน้ากากชนิดใดที่เหมาะสมที่สุดสำหรับการพ่นสีเพื่อป้องกันไอระเหยของสารเคมี",
            "หน้ากากผ้า",
            "หน้ากากอนามันทางการแพทย์",
            "หน้ากากกรองอากาศชนิดครึ่งหน้า(Half-face Respirator)พร้อมไส้กรอกสารเคมี",
            "หน้ากากกันฝุ่นทั่วไป",
            "ค",
          ],
          [
            " เครื่องมือใดที่ใช้ในการขัดผิวงานสีเพื่อให้พื้นผิวเรียบ?",
            "กระดาษทราย",
            "เครื่องขัดแบบสั่น",
            "แปรงทาสี",
            "สเปรย์เคลือบ",
            "ก",
          ],
          [
            "เครื่องมือใดที่ใช้ในการทาสีให้พื้นผิวที่มีขนาดกว้าง เช่น ผนัง?",
            "แปรงทาสี",
            "ลูกกลิ้งทาสี",
            "ปืนพ่นสี",
            "ไม้พาย",
            "ก",
          ],
          [
            "การเลือกสีทาผนังภายในควรพิจารณาจากอะไรเป็นหลัก?",
            "ความทนทานต่อสภาพอากาศ",
            "ความเงางามของสี",
            "ความปลอดภัยและมิตรต่อสิ่งแวดล้อม",
            "สีที่มีราคาถูก",
            "ง",
          ],
          [
            "การใช้ปืนพ่นสีมีข้อดีอย่างไร?",
            "สามารถทาสีได้เร็ว",
            "ใช้ในพื้นที่แคบได้ดี",
            "ได้สีที่ละเอียดและสม่ำเสมอ",
            "ใช้งานได้ในทุกสภาพอากาศ",
            "ง",
          ],
          [
            "การทาสีด้วยแปรงมีข้อดีอย่างไร?",
            "ใช้ได้ดีในพื้นที่แคบ",
            "ทาสีได้เร็วกว่าเครื่องมืออื่น",
            "ได้สีที่ละเอียดและสม่ำเสมอ",
            "ใช้งานได้ในทุกสภาพอากาศ",
            "ง",
          ],
        ];

        questions.forEach((q, index) => {
          multipleChoiceList.innerHTML += `
      <div class="mb-4">
        <div class="d-flex align-items-center">
          <strong>ข้อที่ ${index + 1}:</strong>
          <input type="text" class="form-control mx-2" value="${q[0]}">
          <label class="btn btn-outline-primary">
            <i class="bi bi-image"></i>
            <input type="file" class="d-none" onchange="previewImage(this)">
          </label>
        </div>
        
        <ul class="list-unstyled">
          ${["ก", "ข", "ค", "ง"]
            .map(
              (choice, i) => `
            <div class="d-flex align-items-center mt-2">
              <input type="radio" name="choices${index}" class="form-check-input me-2" value="${choice}">
              <label class="me-2">${choice}</label>
              <input type="text" class="form-control w-auto" value="${
                q[i + 1]
              }">
              <button class="btn ms-2" onclick="removeOption(this)">
                <i class="bi bi-x"></i>
              </button>
            </div>
          `
            )
            .join("")}
        </ul>

        <strong>คำตอบ:</strong>
        <select class="form-control">
          ${["ก", "ข", "ค", "ง"]
            .map(
              (choice) => `
            <option value="${choice}" ${
                q[5] === choice ? "selected" : ""
              }>${choice}</option>
          `
            )
            .join("")}
        </select>
        <hr>
      </div>
    `;
        });
      });

      //ฟังก์ชันลบตัวเลือก
      function removeOption(button) {
        const optionDiv = button.closest(".d-flex");
        optionDiv.remove();
      }
      
      function previewImage(input) {
    const file = input.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function (e) {
        // หา div คำถามที่รูปควรแสดงด้านล่าง
        const questionDiv = input.closest(".mb-4");

        // ตรวจสอบว่ามี image-container หรือยัง ถ้าไม่มีให้สร้างใหม่
        let imageContainer = questionDiv.querySelector(".image-container");
        if (!imageContainer) {
            imageContainer = document.createElement("div");
            imageContainer.classList.add("image-container", "mt-3");

            // เพิ่ม imageContainer เข้าไปใน questionDiv
            questionDiv.appendChild(imageContainer);
        }

        // เพิ่มรูปภาพเข้าไป
        const imgWrapper = document.createElement("div");
        imgWrapper.classList.add("text-center", "mb-2");
        imgWrapper.innerHTML = `
         <div class="d-flex align-items-center">
            <img src="${e.target.result}" class="img-thumbnail me-2" style="max-width: 400px;">
            <button class="btn btn-danger btn-sm mt-2" onclick="removeImage(this)">ลบ</button>
        </div>`;

        imageContainer.appendChild(imgWrapper);
    };
    reader.readAsDataURL(file);
}

// ฟังก์ชันลบรูปภาพ
function removeImage(button) {
    button.parentElement.remove();
}

    </script>
  </body>
</html>
